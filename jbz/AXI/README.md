# 访存的几种解决方案

目前cache或者测试的CPU都是按照sram的协议访存，在后续的实现中，sram不能满足需要。sram协议要求读写数据在当拍或者下一拍与时钟信号同步返回，无握手信号；但实际应用中访存延时未知，可能会数个时钟周期后才能返回所需的数据，所以需要支持握手协议的信号，如官方提供的**类sram**协议和**AXI**协议。

我考虑了有如下几种方案：

### 1.内部信号实现为官方的*类sram*协议，使用官方的转换器转为AXI

此方案优点为简单，便于实现；CPU与cache只需按照类sram协议访存，封装时加上转换桥即可。（官方虽然在他们提供的说明文件里提到该转换桥效率较低，但我认为这个效率问题是类sram协议所导致，从官方提供的转换桥的仿真结果看，单纯再写一个从类sram转AXI协议效率并不见得能比官方的好）。缺点也是效率问题，该类sram协议规定了每次传输最多一个字，完全无法利用AXI协议的burst传输等特性。

### 2.内部访存信号直接使用AXI协议

这种方法就是直接在CPU和cache需要访存的地方按照AXI协议发出请求，不使用额外的转换桥，有充分的自由度使用AXI协议的种种功能，延时低，传输量大，性能理论上来说最好；缺点就是AXI协议接口较复杂，访存模块编写困难。且工作需要与cache的编写紧密配合。

### 3.自定义内部访存的信号，自实现转换桥转为AXI协议

这种方法可以突破官方类sram协议不支持burst传输，效率低等缺陷，且可以将内部访存协议定义地较为简单，方便cache和CPU访存部分的编写，便于分工合作。但自实现的协议可能存在不完善的地方，自实现转换桥和协议也会导致工作量较大。

# AXI

AXI为Advanced eXtensible Interface总线协议，支持握手，突发，乱序，非对齐传输等功能。

注意：当前模块暂未实现乱序和非对齐传输。**且仍需与cache进行适配**，因为需要在cache中确定访存请求的格式。

为了满足AXI协议格式的读写请求，模块中使用有限状态机生成信号。

读部分：

<div align="center">
    <img src="..\attachment\image-20200614162830835.png" style="width:70%" />
</div>


写部分：

<div align="center">
    <img src="..\attachment\image-20200614162857629.png" style="width:70%" />
</div>